<!DOCTYPE html>
<html lang="en">
  <head>
    	<meta charset="utf-8" />
    	<title>Auth test!</title>

        <script src="https://accounts.google.com/gsi/client?onload=init" async defer></script>

        <meta name="google-signin-client_id" content="651009588788-nbr42m57t3mk27kvl1tlg5269to910fm.apps.googleusercontent.com">

        <script>
            function init() {
                gapi.load('auth2', function() {
                    /* Ready. Make a call to gapi.auth2.init or some other API */
                    gapi.auth2.init().then(function () {
                    checkLoginState();
                    });
                });
            }

            function onSignIn(googleUser) {
                // Get the user's profile information
                var profile = googleUser.getBasicProfile();
                console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
                console.log('Full Name: ' + profile.getName());
                console.log('Given Name: ' + profile.getGivenName());
                console.log('Family Name: ' + profile.getFamilyName());
                console.log('Image URL: ' + profile.getImageUrl());
                console.log('Email: ' + profile.getEmail());

                // The ID token you need to pass to your backend:
                var id_token = googleUser.getAuthResponse().id_token;
                console.log('ID Token: ' + id_token);

                checkLoginState();
            }

            function signOut() {
                var auth2 = gapi.auth2.getAuthInstance();
                auth2.signOut().then(function () {
                    // Update UI to reflect logged out state
                    checkLoginState();
                });
            }

            function updateLoginUI() {
                var auth2 = gapi.auth2.getAuthInstance();
                if (auth2.isSignedIn.get()) {
                    // User is signed in.
                    // Hide the sign-in button and show the logout area
                    document.getElementById('signin-container').style.display = 'none';
                    document.getElementById('user-content').style.display = 'block';
                    // You can also update 'user-content' with the user's information
                } else {
                    // User is not signed in.
                    // Show the sign-in button and hide the logout area
                    document.getElementById('signin-container').style.display = 'block';
                    document.getElementById('user-content').style.display = 'none';
                }
            }

        </script>

	</head>
	<body>
		
        <!-- For future reference https://developers.google.com/identity/gsi/web/guides/migration#popup-mode_1 -->
        

        <!-- Container for the Sign-In button -->
        <!-- Note: The button does some bullshit to fetch the CSS with the linked JS. It won't work if opening the page as a file. Needs to run off a server, even if just localhost-->
        <!-- Note: see this stuff for the control panel on the goog login stuff: https://console.cloud.google.com/apis/credentials?authuser=2&organizationId=0&project=oauth-test-404216-->
        <div id="g_id_onload"
            data-client_id="651009588788-nbr42m57t3mk27kvl1tlg5269to910fm"></div>
        </div>
        
        <!-- Container for the content shown after login - hidden by default -->
        <div id="user-content" style="display: none;">
            <p>Funny text goes here!</p>
            <button id="signout-button" onclick="signOut();">Sign Out</button>
        </div>
        

	</body>
</html>